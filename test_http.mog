// Minimal test

fn main() -> i64 {
  print_string("Starting...");
  println();
  
  sockfd: i64 = sys_socket(2, 1, 0);
  print_string("Socket: ");
  print(sockfd);
  println();
  
  addr: i64 = sys_inet_addr("52.204.75.48");
  print_string("Addr: ");
  print(addr);
  println();
  
  result: i64 = sys_connect(sockfd, addr, 80);
  print_string("Connect: ");
  print(result);
  println();
  
  msg: ptr = "GET /get HTTP/1.1\r\nHost: httpbin.org\r\n\r\n";
  sent: i64 = sys_send(sockfd, msg, 47);
  print_string("Sent: ");
  print(sent);
  println();
  
  buf: ptr = gc_alloc(1024);
  received: i64 = sys_recv(sockfd, buf, 1024);
  print_string("Received: ");
  print(received);
  println();
  
  sys_close(sockfd);
  
  return 0;
}
